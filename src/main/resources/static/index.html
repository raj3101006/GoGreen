<!DOCTYPE html>
<html>
<head>
<title>Greenish Plant | E-Commerce</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#f2f8f2}
header{background:#0f5132;color:white;padding:15px;text-align:center}
button{padding:8px 15px;background:#198754;color:white;border:none;border-radius:5px;cursor:pointer}
input{padding:8px;margin:5px}
.card{background:white;padding:15px;margin:10px;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.1);display:inline-block;width:200px}
#popup{position:fixed;top:0;left:0;width:100%;height:100%;background:black;color:white;display:flex;align-items:center;justify-content:center;font-size:25px}
footer{background:#0f5132;color:white;text-align:center;padding:10px;margin-top:40px}
</style>
</head>

<body>

<div id="popup">ðŸŒ¿ Welcome to Greenish Plant<br>Developed by Vivek Sharma</div>

<header>
Greenish Plant E-Commerce
</header>

<div id="loginBox">
<h3>Login</h3>
<input id="name" placeholder="Name">
<input id="phone" placeholder="Phone">
<button onclick="login()">Login</button>
</div>

<div id="dashboard" style="display:none">
<h3>Products</h3>
<div id="products"></div>

<h3>Track Order</h3>
<input id="trackId" placeholder="Order ID">
<button onclick="track()">Track</button>
<div id="result"></div>
</div>

<div id="admin" style="display:none">
<h3>Admin Panel</h3>
<div id="orders"></div>
</div>

<footer>
Â© 2026 Greenish Plant | Developed by Vivek Sharma
</footer>

<script>
setTimeout(()=>document.getElementById("popup").style.display="none",2000)

let user=null

function login(){
fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},
body:JSON.stringify({name:name.value,phone:phone.value})})
.then(r=>r.json())
.then(d=>{
user=d
login.style.display="none"
if(d.role==="ADMIN"){admin.style.display="block";loadOrders()}
else{dashboard.style.display="block";loadProducts()}
})
}

function loadProducts(){
fetch("/api/products")
.then(r=>r.json())
.then(data=>{
products.innerHTML=""
data.forEach(p=>{
products.innerHTML+=`
<div class="card">
<h4>${p.name}</h4>
<p>â‚¹ ${p.price}</p>
<button onclick="buy('${p.name}',${p.price})">Buy</button>
</div>`
})
})
}

function buy(name,price){
if(!confirm("Proceed to Payment Demo?")) return
fetch("/api/order",{method:"POST",headers:{"Content-Type":"application/json"},
body:JSON.stringify({user:user.name,product:name,price:price})})
.then(r=>r.json())
.then(d=>alert("Order ID: "+d.orderId))
}

function loadOrders(){
fetch("/api/orders")
.then(r=>r.json())
.then(data=>{
orders.innerHTML=""
data.forEach(o=>{
orders.innerHTML+=`
<div class="card">
<p>${o.product}</p>
<p>${o.orderId}</p>
<p>${o.status}</p>
<button onclick="updateStatus('${o.orderId}','SHIPPED')">Ship</button>
<button onclick="updateStatus('${o.orderId}','DELIVERED')">Deliver</button>
</div>`
})
})
}

function updateStatus(id,status){
fetch("/api/update",{method:"POST",headers:{"Content-Type":"application/json"},
body:JSON.stringify({orderId:id,status:status})})
.then(()=>loadOrders())
}

function track(){
fetch("/api/track/"+trackId.value)
.then(r=>r.json())
.then(d=>result.innerHTML=d.status? "Status: "+d.status : "Not Found")
}
</script>

</body>
</html>
